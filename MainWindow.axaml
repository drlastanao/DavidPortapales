<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="using:DavidPortapales"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
        x:Class="DavidPortapales.MainWindow"
        x:DataType="local:MainWindow"
        Title="Monitor de Portapapeles"
        x:Name="RootWindow"
        Icon="/Assets/clipboard_icon.png"
        SystemDecorations="None"
        Topmost="True"
        Background="Transparent"
        TransparencyLevelHint="AcrylicBlur"
        WindowStartupLocation="Manual">
        
    <Grid>
        <!-- Vista Minimizada (Widget) -->
        <Border Name="MiniWidget"
                Background="#202020" 
                CornerRadius="10" 
                Width="50" Height="50"
                IsVisible="True"
                Padding="10">
             <Image Source="/Assets/clipboard_icon.png" />
        </Border>

        <!-- Vista Expandida (Historial) -->
        <Border Name="MainView"
                Background="#1E1E1E"
                BorderBrush="#404040"
                BorderThickness="1"
                IsVisible="False">
            <Grid RowDefinitions="Auto,*">
                <DockPanel Grid.Row="0" Background="#2D2D30" LastChildFill="False">
                    <TextBlock Text="Historial" VerticalAlignment="Center" Margin="10" FontWeight="Bold" Foreground="#E0E0E0"/>
                    <Button Content="Minimizar (Doble Click)" DockPanel.Dock="Right" Click="OnMinimizeClick" Margin="5" Foreground="#E0E0E0" Background="#3E3E42" BorderBrush="#505050"/>
                </DockPanel>
                
                <ListBox Grid.Row="1" ItemsSource="{Binding History}" Margin="10">
                    <ListBox.ItemTemplate>
                        <DataTemplate DataType="local:ClipboardItem">
                            <Border BorderBrush="#3E3E42" BorderThickness="0,0,0,1" Padding="5">
                                <DockPanel>
                                    <StackPanel DockPanel.Dock="Right" VerticalAlignment="Top" Margin="10,0,0,0">
                                        <Button Content="Copiar" Click="OnCopyClick" IsVisible="{Binding IsText}"/>
                                        <Button Content="Salvar" Click="OnSaveClick" IsVisible="{Binding IsImage}"/>
                                    </StackPanel>
                                    
                                    <StackPanel Spacing="5">
                                        <StackPanel Orientation="Horizontal" Spacing="10">
                                            <TextBlock Text="{Binding TimestampDisplay}" FontWeight="Bold" Foreground="#FFFFFF" FontSize="12"/>
                                            <TextBlock Text="{Binding TypeDisplay}" Foreground="#569CD6" FontSize="12"/>
                                        </StackPanel>
                                        
                                        <StackPanel IsVisible="{Binding IsText}">
                                            <TextBlock Text="{Binding TextContent}" TextWrapping="Wrap" MaxHeight="100" Foreground="#E0E0E0"/>
                                            <StackPanel Orientation="Horizontal" Spacing="10" Margin="0,5,0,0">
                                                <TextBlock Text="{Binding CharCount, StringFormat='Carácteres: {0}'}" FontSize="10" Foreground="#CCCCCC"/>
                                                <TextBlock Text="{Binding WordCount, StringFormat='Palabras: {0}'}" FontSize="10" Foreground="#CCCCCC"/>
                                            </StackPanel>
                                        </StackPanel>
                                        
                                        <StackPanel IsVisible="{Binding IsImage}">
                                            <Image Source="{Binding ImageContent}" MaxHeight="200" Stretch="Uniform" HorizontalAlignment="Left"/>
                                            <StackPanel Orientation="Horizontal" Spacing="10" Margin="0,5,0,0">
                                                <TextBlock Text="Resolución:" FontSize="10" Foreground="#CCCCCC"/>
                                                <TextBlock Text="{Binding ImageWidth}" FontSize="10" Foreground="#CCCCCC"/>
                                                <TextBlock Text="x" FontSize="10" Foreground="#CCCCCC"/>
                                                <TextBlock Text="{Binding ImageHeight}" FontSize="10" Foreground="#CCCCCC"/>
                                                <TextBlock Text="px" FontSize="10" Foreground="#CCCCCC"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </DockPanel>
                            </Border>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Grid>
        </Border>
    </Grid>
</Window>
